---
kind: pipeline
type: docker
name: default

steps:
- name: terraform plan
  image: jmccann/drone-terraform:latest
  actions:
  - plan
  sensitive: true
  var_files:
  - prod.tfvars

- name: terraform deploy
  image: jmccann/drone-terraform:latest
  actions:
  - apply
  sensitive: true
  var_files:
  - prod.tfvars

when:
  branch:
  - main